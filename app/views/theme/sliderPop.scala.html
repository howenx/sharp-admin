@(themeList:List[entity.Theme], skusList:List[entity.Skus], url:String)
<!doctype html>
<html lang="en">
<head>
        <meta charset="UTF-8">
        <title>选择主题或商品</title>
        <link rel="shortcut icon" type="image/png" href="/assets/images/favicon.ico">
        <link rel="stylesheet" href="/assets/css/bootstrap.min.css" >
        <script src="/assets/js/jquery.min.js"></script>
        <link rel="stylesheet" href="/assets/css/search.css" >
        <script>
        $(function(){
            var sharedObject = window.dialogArguments;
            var itemTarget = sharedObject.itemTarget;
            var targetType = sharedObject.targetType;
            var tableIndex = 0;
            var selectIndex = 0;
            if (itemTarget!="") {
                var typeId = itemTarget.substring(itemTarget.lastIndexOf("/")+1,itemTarget.length);
                if ((targetType=="D" || targetType=="P" || targetType=="")) {
                    tableIndex = 0;
                    selectIndex = 4;
                    $(".goods-table").css("background","#ccc");
                    $(".theme-table").css("background","#fff");
                    $(".table").eq(0).css("display","table");
                    $(".table").eq(1).css("display","none");
                    targetType = "D";
                }
                if (targetType=="T" || targetType=="U") {
                    tableIndex = 1;
                    selectIndex = 1;
                    $(".goods-table").css("background","#fff");
                    $(".theme-table").css("background","#ccc");
                    $(".table").eq(0).css("display","none");
                    $(".table").eq(1).css("display","table");
                    targetType = "T";
                }
                var trs = $(".table").eq(tableIndex).find("tr");
                for(j=1;j<trs.length;j++) {
                    if (typeId==trs[j].getElementsByTagName("td")[selectIndex].innerText) {
                        $(trs[j].getElementsByTagName("td")[0].getElementsByTagName("input")[0]).attr("checked",true);
                        $(trs[j]).css("background","#f5f5f5");
                    }
                }
            }
            if (itemTarget=="") {
                targetType = "D"
            }

            /**	变换选择显示主题列表或商品列表 **/
            $(".switch").click(function(){
                $(".switch").css("background","#fff");//白色
                $(this).css("background","#ccc");     //灰色
                $("table").css("display","none");
                $(".table").eq($(this).index($(".switch"))).css("display","table");
                if($(this).children().html()=="主题选择") targetType = "T";
                if($(this).children().html()=="商品选择") targetType = "D";
            });

            /** 点击单选按钮选择主题或商品 **/
             $(".table input[type=radio]").click(function(){
                //选择商品
                if (targetType=="D") {
                    var itemId = $("input[type=radio]:checked").parent().next().html();
                    var invId = $("input[type=radio]:checked").parent().next().next().html();
                    var itemType = $("input[type=radio]:checked").parent().next().next().next().find(".item-type").val();
                    var skuTypeId = $("input[type=radio]:checked").parent().next().next().next().next().html();
                    sharedObject.itemId = itemId;
                    sharedObject.invId = invId;
                    sharedObject.itemType = itemType;
                    sharedObject.skuTypeId = skuTypeId;
                    sharedObject.targetType = targetType;
                }
                //选择主题
                if (targetType=="T") {
                    var id = $("input[type=radio]:checked").parent().next().html();
                    var thType = $("input[type=radio]:checked").parent().next().next().find(".topic-type").val();
                    if (thType=="ordinary") {targetType = "T"}
                    if (thType=="h5") {targetType = "U"}
                    sharedObject.id = id;
                    sharedObject.targetType = targetType;
                }

                var itemId=$("input[type=radio]:checked").parent().next().html();
                var skuId=$("input[type=radio]:checked").parent().next().next().html();
                sharedObject.itemId = itemId;
                sharedObject.skuId = skuId;
                sharedObject.targetType = targetType;
                if (window.showModalDialog) {
                    window.returnValue = sharedObject;
                }
                else {
                    // if not modal, we cannot use the returnValue property, we need to update the opener window
                    window.opener.UpdateFields (sharedObject);
                }
                window.close ();
            });

            /**	点击排序方式 **/
            $(".sort-topic").click(function(e) {
                if ($(this).hasClass("glyphicon-chevron-up")) {
                    $(this).removeClass("glyphicon-chevron-up");
                    $(this).addClass("glyphicon-chevron-down");
                } else {
                    $(this).removeClass("glyphicon-chevron-down");
                    $(this).addClass("glyphicon-chevron-up");
                }
            });

            /**	图片放大和关闭 **/
            $(document).on("click", ".main-img", function(e) {
                $(".goods-img-bg").css({
                    "height": $(window).height(),
                    "display": "block"
                });
                $(".goods-img").css("left", ($(window).width() - 1200) / 2);
                $(this).clone().appendTo($(".goods-img")).css({
                    "width": "50%",
                    "height": "500px",
                    "margin-left": "300px",
                    "z-index": 1000
                });
            })
            $(document).on("click", ".goods-img-bg .close", function(e) {
                $(".goods-img-bg img").remove();
                $(".goods-img-bg").css({
                    "display": "none"
                });
            })
            $(document).on("click", ".goods-bg", function(e) {
                $(".goods-img-bg img").remove();
                $(".goods-img-bg").css({
                    "display": "none"
                });
            })
        })

    </script>
</head>
<body>
<div class="table-two clearfix">
    <div class="goods-table pull-left switch"><span>商品选择</span></div>
    <div class="theme-table pull-left switch"><span>主题选择</span></div>
        <!--SKU-->
        <table class="table table-bordered table-hover table-goods">
            <tr>
                <th>选择商品</th>
                <th style="display:none;">商品ID</th>
                <th>SKU ID</th>
                <th>商品类型</th>
                <th>类型 ID</th>
                <th>商品标题</th>
                <th>主图</th>
                <th>上架时间</th>
                <th>下架时间</th>
                <th>状态</th>
                <th>现价(￥)</th>
                <th>原价(￥)</th>
                <th>折扣</th>
            </tr>
            @for(sku <- skusList) {
            <tr>
                <td><input type="radio" name="selectItem"></td>
                <td style="display:none;">@sku.getItemId()</td>
                <td>@sku.getInvId()</td>
                <td>
                    @if(sku.getSkuType()=="item"){普通商品}
                    @if(sku.getSkuType()=="pin"){拼购商品}
                    <input class="item-type" type="hidden" value="@sku.getSkuType()">
                </td>
                <td>@sku.getSkuTypeId()</td>
                <td>@sku.getSkuTypeTitle()</td>
                <td><img class="main-img" src='@url@sku.getSkuTypeImg()' alt="" width="50"></td>
                <td>@(sku.getSkuTypeStartAt().toString().substring(0,16))</td>
                <td>@(sku.getSkuTypeEndAt().toString().substring(0,16))</td>
                <td>
                    @if(sku.getSkuTypeStatus()=="Y") {正常}
                    @if(sku.getSkuTypeStatus()=="D") {下架}
                    @if(sku.getSkuTypeStatus()=="N") {删除}
                    @if(sku.getSkuTypeStatus()=="K") {售空}
                    @if(sku.getSkuTypeStatus()=="P") {预售}
                </td>
                <td>@sku.getSkuTypePrice()</td>
                <td>@sku.getItemSrcPrice()</td>
                <td>@sku.getSkuTypeDiscount()</td>
            </tr>
            }
        </table>
        <!--主题-->
        <table class="table table-bordered table-hover table-theme">
                <tr>
                        <th>选择主题</th>
                        <th>主题ID<span class="sort-topic glyphicon glyphicon-chevron-up"></span></th>
                        <th>类型</th>
                        <th>主题图片</th>
                        <th>开始时间<span class="sort-topic glyphicon glyphicon-chevron-up"></span></th>
                        <th>结束时间<span class="sort-topic glyphicon glyphicon-chevron-up"></span></th>
                </tr>
                @for(theme <- themeList) {
                <tr>
                        <td><input type="radio" name="selectTheme"></td>
                        <td>@theme.getId()</td>
                        <td>
                            @if(theme.getType()=="ordinary"){普通主题}
                            @if(theme.getType()=="h5"){HTML5}
                            <input class="topic-type" type="hidden" value="@theme.getType()">
                        </td>
                        <td><img class="main-img" src='@url@theme.getThemeImg()' alt="" width="50"></td>
                        <td>@theme.getStartAt()</td>
                        <td>@theme.getEndAt()</td>
                </tr>
                }
        </table>
</div>

<div class="goods-img-bg">
        <div class="goods-bg"></div>
        <div class="goods-img">
                <button type="button" class="close" aria-label="Close" style="position: absolute;right: 283px;top: -18px;"><span aria-hidden="true">&times;</span></button>
        </div>
</div>

</body>
</html>