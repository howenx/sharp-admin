@import play.i18n._
@(lang:String="cn",theme:entity.Theme,itList:List[Array[Object]],themeImgObject:Array[Object],masterImgObject:Array[Object],tagList:List[Array[Object]],url:String,user:entity.User)
@import play.api.libs.json.Json
@scripts = {

<link rel="stylesheet" href="/assets/css/jquery-ui.css">
<link rel="stylesheet" href="/assets/css/slider.css">
<link rel="stylesheet" href="/assets/css/screenshot.css">
<link rel="stylesheet" href="/assets/css/upload.css">
<link rel="stylesheet" href="/assets/css/button.css">
<link rel="stylesheet" href="/assets/css/font-face.css">
<link href="/assets/css/bootstrap-datetimepicker1.css" rel="stylesheet">

<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/jquery-ui.min.js"></script>
<script src="/assets/js/Math.uuid.js"></script>
<script src="/assets/js/upload.style.js"></script>
<script src="/assets/js/shot.style.js"></script>
<script src="/assets/js/slider.js"></script>
<script src="/assets/js/search.js"></script>
<script src="/assets/js/moment-with-locales.js"></script>
<script src="/assets/js/bootstrap-datetimepicker1.js"></script>
<script src="/assets/js/rili.js"></script>
<script src="/assets/js/theme.js"></script>

<script>
    $(function(){
        //主题主宣传图
        $("#themeImg").find("img").attr("id","@url@themeImgObject(0)");
        $("#themeImg").find("input").width("@themeImgObject(1)");
        $("#themeImg").find("input").height("@themeImgObject(2)");

        //主题列表主图
        var img = document.createElement("img");
        $(img).attr("src","@url@masterImgObject(0)");
        $(img).css({"width":"100%","height":"100%","float":"left"});
        $("#dragon-container").append(img);
        $("#dragon-container").width(@masterImgObject(1));
        $("#dragon-container").height(@masterImgObject(2));
        //主题列表主图宽高
        var input = document.createElement("input");
        input.id = "@url@masterImgObject(0)";
        input.type = "hidden";
        $(input).width(@masterImgObject(1));
        $(input).height(@masterImgObject(2));
        $("#dragon-container").append(input);
        $("#dragon-container").css({"margin":"0"});

        //主题标签
        $("#dragon-container").find(".dragon-contained").each(function(){
            //角度180度
            if($(this).find(".dragon-graph").css('transform').indexOf("-1")>=0){
                $(this).css("left",parseInt($(this).css("left")) - $(this).width());
            }
        })

  		//非编辑状态下冻结页面元素
  		//保存按钮
  		$("#js-usercenter-submit").css({"display":"none"});
  		$("#js-usercenter-cancel").css({"display":"none"});

  		//基本信息
  		$("#themeTitle").attr("disabled",true);
  		$("#onShelvesAt").attr("disabled",true);
  		$("#offShelvesAt").attr("disabled",true);
  		//主宣传图
  		$("#getTemplate").css({"display":"none"});
        //商品
  		$(".add-goods").css({"display":"none"});

        $("#sort").find("tr").each(function(){
            if($(this).find("th").length != 0 ){
                $(this).find("th:eq(9)").css({"display":"none"});
            }else{
                $(this).find("td:eq(9)").css({"display":"none"});
            }
        })

        //主题主图
  		$(".form-group").eq(5).css({"display":"none"});
  		$(".form-group").eq(6).css({"display":"none"});
  		$(".form-group").eq(7).css({"display":"none"});
  		$(".form-group").eq(8).css({"display":"none"});
  		$(".form-group").eq(9).css({"display":"none"});


        //点击编辑
        $(document).on("click","#js-usercenter-edit",function(){
        //保存按钮
  		$("#js-usercenter-submit").css({"display":""});
  		$("#js-usercenter-edit").css({"display":"none"});
  		$("#js-usercenter-cancel").css({"display":""});
        //基本信息
  		$("#themeTitle").attr("disabled",false);
  		$("#onShelvesAt").attr("disabled",false);
  		$("#offShelvesAt").attr("disabled",false);
  		//主宣传图
  		$("#getTemplate").css({"display":""});
        //商品
  		$(".add-goods").css({"display":""});
        $("#sort").find("tr").each(function(){
            if($(this).find("th").length != 0 ){
                $(this).find("th:eq(9)").css({"display":""});
            }else{
                $(this).find("td:eq(9)").css({"display":""});
            }
        })
        //主题主图
  		$(".form-group").eq(5).css({"display":""});
  		$(".form-group").eq(6).css({"display":""});
  		$(".form-group").eq(7).css({"display":""});
  		$(".form-group").eq(8).css({"display":""});
  		$(".form-group").eq(9).css({"display":""});

  		//启动tag拖拽功能
        $('div.dragon-contained').draggable({
  		    containment: "parent"
  		});

        })

        //点击取消
        $(document).on("click","#js-usercenter-cancel",function(){
        //保存按钮
  		$("#js-usercenter-submit").css({"display":"none"});
  		$("#js-usercenter-cancel").css({"display":"none"});
  		$("#js-usercenter-edit").css({"display":""});

  		//基本信息
  		$("#themeTitle").attr("disabled",true);
  		$("#onShelvesAt").attr("disabled",true);
  		$("#offShelvesAt").attr("disabled",true);
  		//主宣传图
  		$("#getTemplate").css({"display":"none"});
        //商品
  		$(".add-goods").css({"display":"none"});

        $("#sort").find("tr").each(function(){
            if($(this).find("th").length != 0 ){
                $(this).find("th:eq(9)").css({"display":"none"});
            }else{
                $(this).find("td:eq(9)").css({"display":"none"});
            }
        })

        //主题主图
  		$(".form-group").eq(5).css({"display":"none"});
  		$(".form-group").eq(6).css({"display":"none"});
  		$(".form-group").eq(7).css({"display":"none"});
  		$(".form-group").eq(8).css({"display":"none"});
  		$(".form-group").eq(9).css({"display":"none"});


        })

    })
</script>
}
@import java.lang.String; val title=Messages.get(new Lang(Lang.forCode(lang)),"主题详情")

@layout(lang=lang,title=title,user=user)(scripts) {
<div class="mbread">
    <div class="bread-path">
        <span class="index">@Messages.get(new Lang(Lang.forCode(lang)),"page.head.path.title")</span>
        <a href="/@lang/front"><span class="current">@Messages.get(new Lang(Lang.forCode(lang)),"nav.home")</span></a>
        <span class="icon-path">&gt;</span>
        <span class="current">@Messages.get(new Lang(Lang.forCode(lang)),"nav.themes")</span>
        <span class="icon-path">&gt;</span>
        <span>主题详情</span>
    </div>
</div>
<div class="wrap-slider">
    <div class="page-title">
        <span class="title-name">主题详情</span>
    </div>
    <div class="usercenter-option">
        <div class="user-state fl">@Messages.get(new Lang(Lang.forCode(lang)),"themes.slider.state1")</div>
        <div  id="js-usercenter-submit" class="btn-blue btn-form fr ml15">@Messages.get(new
            Lang(Lang.forCode(lang)),"themes.slider.save")</div>
        <div  id="js-usercenter-edit" class="btn-blue btn-form fr ml15">编辑</div>
        <div id="js-usercenter-cancel" class="btn-white btn-form fr ml20">@Messages.get(new
            Lang(Lang.forCode(lang)),"themes.slider.cancel")</div>
        <span id="js-userinfo-error" class="mt20 alt fr"></span>
    </div>
    <div class="row">
        <form class="form-horizontal">
            <!-- 基本信息-->
            <h4 class="h4-custom-hmm">基本信息</h4>
            <div class="form-group">
                <label class="col-sm-2 control-label">主题ID</label>

                <div class="col-sm-8">
                    <input type="text" class="form-control" value="@theme.getId()" id="themeId" disabled/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">主题标题</label>

                <div class="col-sm-8">
                    <input type="text" class="form-control" value="@theme.getTitle()" id="themeTitle"/>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">开始日期</label>

                <div class="col-sm-8">
                    <div class="input-group date" id='datetimepicker1'>
                        <input class="form-control col-sm-2" type="text" value="@theme.getStartAt()" id="onShelvesAt" name="onShelvesAt">
                        <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">结束日期</label>

                <div class="col-sm-8">
                    <div class="input-group date" id='datetimepicker2'>
                        <input class="form-control col-sm-2" type="text" value="@theme.getEndAt()" id="offShelvesAt" name="offShelvesAt">
                        <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                    </div>
                </div>
            </div>
            <hr/>
            <!-- 上传图片-->
            <h4 class="h4-custom-hmm">主宣传图</h4>

            <div class="form-group">
                <div class="col-sm-2">
                    <a href="javascript:void(0)" id="getTemplate" class="upload-label btn-primary btn-xs" style="float: right">
                        选择模板
                    </a>
                </div>
                <div class="col-sm-9">
                    <div id="themeImg" style="width: 100%;height: 300px;border: 1px solid #ccc">
                        <img src="@url@themeImgObject(0)" width="100%" height="100%"/>
                        <input id="@url@themeImgObject(0)" type="hidden" width="@themeImgObject(1)" height="@themeImgObject(2)">
                    </div>
                </div>
                <!--
                <label class="col-sm-2 control-label">选择主题</label>

                <div class="col-sm-9">
                    <div class="rec_sku-title">
                        <!--
                        <input type="radio" data-xr='u_youjipin' class="set-main temp_radio_class" name="setMain">
                        <label class="radio">宽版</label>
                        <input type="radio" data-xr='q_youjipin' class="set-main temp_radio_class" name="setMain">
                        <label class="radio">拼购打折</label>
                        -->
                <!--
                        <input type="radio" data-xr='shop_unpack' class="set-main temp_radio_class" name="setMain" checked>
                        <label class="radio">批购</label>
                        <!--
                        <input type="radio" data-xr='upload-img' class="set-main temp_radio_class" name="setMain">
                        <label class="radio">上传</label>
                     -->
                <!--
                    </div>
                    <div class='compress-div'>
                        <!--宽版-->
                <!--
                        <div class='li-dv'>
                            <div id='u_youjipin' class="goods_list_img">
                                <div class="img">
                                    <a href="javascript:void(0)" class="upload-a btn-primary">
                                        上传图片
                                        <input type="file" class="upload2">
                                    </a>
                                    <span data-index='0' class="onlyday" style="display: none">仅剩10天</span>
                                </div>
                                <div class="text">
                                    <i data-index='1' style='font-style: normal;'>★以思念为料，享受烘焙的甜蜜★</i>
                                        <span>
                                            <b data-index='2'>6</b>
                                            <i data-index='3' style='font-style: normal;'>元起</i>
                                        </span>
                                </div>
                            </div>
                            <div class="pre_temp">
                                <table>
                                    <tbody>
                                    <tr>
                                        <th>仅剩：</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>标题：</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>价格/折扣：</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>元/折起：</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr style="display: none">
                                        <th>图片url:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>原始宽高：</th>
                                        <td><input name='origin_wh' type="checkbox"></td>
                                    </tr>
                                    <tr>
                                        <th>宽度：</th>
                                        <td><input name='custom_w' class='size' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>高度：</th>
                                        <td><input name='custom_h' class='size' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th></th>
                                        <td><a name='pre_unpack_bt' class="small blue-light button">预览</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!--拼购打折-->
                <!--
                        <div class='li-dv'>
                            <div id="q_youjipin" class="pingou">
                                <div class="img">
                                    <a href="javascript:void(0)" class="upload-a btn-primary">
                                        上传图片
                                        <input type="file" class="upload1">
                                    </a>
                                </div>
                                <div class="text">
                                    <div class="illustrate-box">
                                        <div class="illustrate-l">
                                            <div class="sale">
                                                    <span class="sale-rate">
                                                        <span data-index='0'>20%</span>
                                                        <i>打折率:</i>
                                                    </span>

                                            </div>
                                            <div class="money">
                                                <span class="money-raw">市场价:<i data-index='1'>￥600</i></span>
                                                <span class="now">折扣价:<i data-index='2'>￥480</i></span>
                                            </div>

                                        </div>
                                        <div class="illustrate-r">
                                            <span class="one">拼购打折<i>(最低)</i></span>
                                            <span class="two" data-index='3'>2人拼购</span>
                                            <span class="three" data-index='4'>￥400</span>
                                            <span class="four" data-index='5'>已拼购2345人</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="pre_temp">
                                <table>
                                    <tbody>
                                    <tr>
                                        <th>折扣率:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>市场价:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>折扣价:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>拼购人数:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>拼购价格:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th>已拼购人数:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr style="display: none">
                                        <th>图片url:</th>
                                        <td><input class='input-area' type="text"></td>
                                    </tr>
                                    <tr>
                                        <th></th>
                                        <td><a name='pre_unpack_bt' class="small blue-light button">预览</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!--拼购-->
                <!--
                        <input type="file" class="unpack_img" style="display: none">
                        <div class='li-dv' style='display: block;'>
                            <div id='shop_unpack' name="temp_unpack" class="li sync-hide auto">
                                <div class='li unpack-temp-img' id='unpack_img'>
                                </div>
                                <div id='unpack_title' class='unpack-title-container'>
                                        <span>
                                            <b id='unpack_discount' style="font-weight: normal;">20</b>
                                            <b style="font-size: 17px;font-weight: normal;">%</b>
                                        </span>
                                    <div id='unpack_price_origin'>￥600.00</div>
                                    <div id='unpack_price_current'>￥480.00</div>
                                    <div id='unpack_vertical_line'></div>
                                    <div id='unpack_span'>年终狂欢<b style="font-size: xx-small;font-weight:normal;">(最低)</b>
                                    </div>
                                    <div id='unpack_price_unpack'>￥400.00</div>
                                </div>
                            </div>
                        </div>
                        <div class="pre_temp shop_unpack">
                            <table>
                                <tbody>
                                <tr>
                                    <th>折扣率:</th>
                                    <td><input class='input-area' type="text"></td>
                                </tr>
                                <tr>
                                    <th>原价:</th>
                                    <td><input class='input-area' type="text"></td>
                                </tr>
                                <tr>
                                    <th>现价:</th>
                                    <td><input class='input-area' type="text"></td>
                                </tr>
                                <tr>
                                    <th>拼购价:</th>
                                    <td><input class='input-area' type="text"></td>
                                </tr>
                                <!--
                                <tr>
                                    <th>宽度:</th>
                                    <td><input class='input-area' type="text"></td>
                                </tr>
                                -->
                <!--
                                <tr>
                                    <th></th>
                                    <td><a name='pre_unpack_bt' class="small blue-light button">预览</a></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <!--上传-->
                <!--
                        <div class='li-dv'>
                            <div id="upload-img">
                                <div class="img">
                                    <a href="javascript:void(0)" class="upload-a btn-primary">
                                        上传图片
                                        <input type="file" class="upload1">
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class='submit-area'>
                        <a class="large blue-light button" id='submit'>提交</a>
                    </div>
                </div>
                -->
            </div>
            <!--
            <div id="mask" class="ui-mask" style="display: none;">
                <div id="circularG">
                    <div id="circularG_1" class="circularG"></div>
                    <div id="circularG_2" class="circularG"></div>
                    <div id="circularG_3" class="circularG"></div>
                    <div id="circularG_4" class="circularG"></div>
                    <div id="circularG_5" class="circularG"></div>
                    <div id="circularG_6" class="circularG"></div>
                    <div id="circularG_7" class="circularG"></div>
                    <div id="circularG_8" class="circularG"></div>
                </div>
            </div>
            -->
            <hr/>
            <!--商品选择-->

            <h4 class="h4-custom-hmm">商品选择</h4>

            <button type="button" class="btn btn-primary btn-xs add-goods" onclick="ShowModal()">添加商品</button>
            <div class="bgk">
                <table class="table table-bordered table-hover grid" id="sort" title="Kurt Vonnegut novels">
                    <thead>
                    <tr>
                        <th class="index">序号</th>
                       <!-- <th>主商品</th> -->
                        <th>
                            商品ID
                            <span class="glyphicon glyphicon-chevron-up"></span>
                            <!--<span class="glyphicon glyphicon-chevron-down"></span>-->
                        </th>
                        <!--
                        <th>
                            商品名称
                            <span class="glyphicon glyphicon-chevron-up"></span>
                            <!--<span class="glyphicon glyphicon-chevron-down"></span>-->
                        <!--
                        </th>
                        -->
                        <th>
                            商品标题
                        </th>
                        <th>
                            主图
                        </th>
                        <th>
                            上架时间
                        </th>
                        <th>
                            商品状态
                        </th>
                        <th>
                            价格
                        </th>
                        <th>
                            原价
                            <span class="glyphicon glyphicon-chevron-up"></span>
                            <!--<span class="glyphicon glyphicon-chevron-down"></span>-->
                        </th>
                        <th>
                            折扣
                            <span class="glyphicon glyphicon-chevron-up"></span>
                            <!--<span class="glyphicon glyphicon-chevron-down"></span>-->
                        </th>
                        <th>
                            删除
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    @for(item <- itList){
                        <tr>
                            <td class="index">@item(8)</td>
                            <!--<td>@if(item(8) == 1){<input type="radio" name="goods-main" checked>}
                                @if(item(8) != 1){<input type="radio" name="goods-main">}
                            </td>
                            -->
                            <td>@item(0)</td>
                            <td>@item(1)</td>
                            <td>
                                <img class="main-img" src="@url@item(2)" alt="" width="50">
                            </td>
                            <td>@item(3)</td>
                            <td>@item(4)</td>
                            <td>@item(5)</td>
                            <td>@item(6)</td>
                            <td>@item(7)</td>
                            <td class="th-del" style="background:#ccc;cursor:pointer;">删除</td>
                        </tr>
                    }
                    </tbody>
                </table>
            </div>
            <hr/>
            <!-- 创建mark-->
            <h4 class="h4-custom-hmm">主题主图</h4>

            <div class="form-group">
                <label class="col-sm-2 control-label">上传图片:</label>

                <div class="col-sm-9">
                    <a href="javascript:void(0)" class="upload-label btn-primary btn-xs">
                        上传图片
                        <input type="file" id="upload-label">
                    </a>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">标签名字:</label>

                <div class="col-sm-9">
                    <input id='mark-nm' type='text' class="form-control">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">标签角度:</label>

                <div class="col-sm-9">
                    <div class="radbd" style="margin-top: 0">
                        <input type="radio" name="mark-deg" value="0"/> <b>0度</b>
                        <input type="radio" name="mark-deg" value="180"/> <b>180度</b>
                    </div>
                </div>
            </div>
            <div class="form-group">

                <label class="col-sm-2 control-label">标签的商品ID:</label>

                <div class="col-sm-8">
                    <input type="text" class="form-control" id="input_imgurl"  disabled>
                </div>

                <div class="col-sm-1">
                    <button type="button" class="btn btn-primary btn-xs label-id" onclick="ShowModal1()">选择</button>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label"></label>
                <div class="col-sm-9">
                    <a class="large blue button" id='mark-bt'>创建</a>
                </div>


            </div>

            <div class="form-group">

                <label class="col-sm-2 control-label"></label>

                <div class="col-sm-9 tag-container">

                    <div id='dragon-container'>
                        <!-- Added by Tiffany Zhu -->
                        @for(tag <- tagList){
                            @if(tag(4).equals("0")){
                                <div class="dragon-contained ui-draggable ui-draggable-handle" style="left: @tag(2); top: @tag(0);">

                                    <div class="dragon-graph" style="transform: rotate(0deg);">
                                        <div class="dragon-circle">
                                            <div class="dragon-circle-inner">
                                            </div>
                                        </div>
                                        <div class="dragon-rectangle">
                                            <div class="dragon-trangle">
                                            </div>
                                            <div class="dragon-text">
                                                <p class="dragon-p">@tag(3)</p>
                                                <!--<input name = @tag(1) type="hidden">-->
                                            </div>

                                        </div>
                                        <div class="dragon-close">
                                        </div>
                                    </div>
                                    <div class = "item-id">@tag(1)</div>
                                </div>
                            }
                            @if(tag(4).equals("180")){
                                <div class="dragon-contained ui-draggable ui-draggable-handle" style="left: @tag(2); top: @tag(0);">

                                    <div class="dragon-graph" style="transform: rotate(180deg);">
                                        <div class="dragon-circle"><div class="dragon-circle-inner">

                                        </div>
                                        </div>
                                        <div class="dragon-rectangle">
                                            <div class="dragon-trangle">
                                            </div>
                                            <div class="dragon-text" style="transform: rotate(180deg); left: 0px;">
                                            <p class="dragon-p">@tag(3)</p>
                                            <!--<input name=@tag(1) type="hidden">-->

                                        </div>

                                        </div>
                                        <div class="dragon-close">
                                        </div>
                                    </div>
                                    <div class="item-id">@tag(1)</div>
                                </div>
                            }
                        }
                        <!-- Added by Tiffany Zhu -->

                    </div>
                    <!--<a class="large red button" id="push">Push Data</a> -->

                    <div class="thumb"
                         style='position: relative;margin-top: 10px;margin-bottom:50px;display:block;'></div>
                </div>
            </div>
        </form>
    </div>
</div>


<div class="goods-img-bg">
    <div class="goods-bg"></div>
    <div class="goods-img">
        <button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    </div>
</div>
}